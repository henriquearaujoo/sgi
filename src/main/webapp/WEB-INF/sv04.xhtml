<ui:fragment xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
	xmlns:jsf="http://xmlns.jcp.org/jsf">




	<div style="padding: 2px 2px">

		<h:form id="cadastro-despesas">

			<p:panelGrid columns="2">
				<p:panelGrid columns="2">
					<h:outputText value="Tipo de Despesa:  " style="font-size:12px" />
					<p:selectOneMenu id="tpdespesa" style="font-size:12px"
						value="#{sv_cadastro_controller.despesa.tipoDespesa}"
						filter="true">
						<f:selectItem itemLabel="Selecione" />
						<f:selectItems value="#{sv_cadastro_controller.tipoDespesa}"
							var="tDespesa" itemLabel="#{tDespesa.nome}"
							itemValue="#{tDespesa}" />
					</p:selectOneMenu>



					<h:outputText value="Despesa de Viagem:  " style="font-size:12px" />
					<p:selectOneMenu style="font-size:12px" filter="true"
						filterMatchMode="contains" converter="categoriaConverter"
						value="#{sv_cadastro_controller.despesa.categoriaDeDespesa}">
						<f:selectItem itemLabel="Categoria despesa"
							itemValue="#{sv_cadastro_controller.categoria}" />
						<f:selectItems value="#{sv_cadastro_controller.categorias}"
							var="categoria" itemLabel="#{categoria.nome}"
							itemValue="#{categoria}" />
					</p:selectOneMenu>

					<h:outputText value="Unidade de Medida:  " style="font-size:12px" />
					<p:selectOneMenu id="unidade" style="font-size:12px"
						value="#{sv_cadastro_controller.despesa.unidadeMedida}"
						filter="true">
						<f:selectItems value="#{sv_cadastro_controller.unidadeMedida}"
							var="despesa" itemLabel="#{despesa.nome}" itemValue="#{despesa}" />
					</p:selectOneMenu>

					<h:outputText value="Quantidade:  " style="font-size:12px" />
					<p:inputText value="#{sv_cadastro_controller.despesa.quantidade}"
						style="font-size:12px">
						<f:convertNumber minFractionDigits="0" />
						<f:ajax event="blur"
							listener="#{sv_cadastro_controller.atualizaTotal()}"
							render="total" />
					</p:inputText>

					<h:outputText value="Valor Real:  " style="font-size:12px" />
					<p:inputText value="#{sv_cadastro_controller.despesa.valorReal}"
						onkeydown="mascaraMoeda(this,moeda);" style="font-size:12px">
						<f:convertNumber minFractionDigits="2" maxFractionDigits="2"
							locale="pt_BR" />
						<f:ajax event="blur"
							listener="#{sv_cadastro_controller.atualizaTotal()}"
							render="total" />
					</p:inputText>

					<h:outputText value="Total real:  " style="font-size:12px" />
					<h:outputText id="total" style="font-size:12px"
						value="#{sv_cadastro_controller.totalReal}"
						onkeydown="mascaraMoeda(this,moeda);">
						<f:convertNumber minFractionDigits="2" maxFractionDigits="2"
							locale="pt_BR" />
					</h:outputText>


					<h:outputText value="Valor Previsto:  " style="font-size:12px" />
					<p:inputText
						value="#{sv_cadastro_controller.despesa.valorPrevisto}"
						onkeydown="mascaraMoeda(this,moeda);" style="font-size:12px">
						<f:convertNumber minFractionDigits="2" maxFractionDigits="2"
							locale="pt_BR" />
						<f:ajax event="blur"
							listener="#{sv_cadastro_controller.atualizaTotalPrevisto()}"
							render="totalprev" />
					</p:inputText>

					<h:outputText value="Total Previsto:  " style="font-size:12px" />
					<p:inputText id="totalprev" onkeydown="mascaraMoeda(this,moeda);"
						readonly="true" value="#{sv_cadastro_controller.totalPrevisto}"
						style="font-size:12px">
						<f:convertNumber minFractionDigits="2" maxFractionDigits="2"
							locale="pt_BR" />
					</p:inputText>

					<p:commandLink styleClass="btn btn-block btn-danger btn-sm"
						type="button" action="#{sv_cadastro_controller.limparDespesa()}"
						onclick="start()" onsuccess="stop()" onerror="stop()"
						update="cadastro-despesas" process="@this"
						style="color:#fff; margin: 2px 2px;">
						<span class="glyphicon glyphicon-trash"></span><span  style="margin: 3px;">Limpar</span>
					</p:commandLink>

					<p:commandLink
						styleClass="btn btn-block btn-primary btn-sm"
						type="button" action="#{sv_cadastro_controller.addDespesa()}"
						onclick="PrimeFaces.monitorDownload(start, stop);"
						rendered="#{sv_cadastro_controller.poderEditar()}"
						update="cadastro-despesas" process="cadastro-despesas"
						style="color:#fff; margin: 2px 2px;">
						<span class="glyphicon glyphicon-floppy-disk"></span><span style="margin: 3px;">Salvar</span>
					</p:commandLink>
				</p:panelGrid>

				<p:dataTable id="table-despesas" style="font-size:12px"
					paginator="true" rows="5"
					value="#{sv_cadastro_controller.despesas}" var="despesa">

					<p:column headerText="Tipo despesa">
						<h:outputText value="#{despesa.tipoDespesa.nome}"
							style="font-size:12px" />
					</p:column>

					<p:column headerText="Despesa">
						<h:outputText value="#{despesa.categoriaDeDespesa.nome}"
							style="font-size:12px" />
					</p:column>

					<p:column style="width:100px">
						<p:commandLink style=";font-size:12px"
							action="#{sv_cadastro_controller.prepararEdicaoDespesas()}"
							process="@this"
							update="form-cadastro-viagem:tab_viagem:cadastro-despesas"
							onclick="start()" onsuccess="stop()" onerror="stop()"
							styleClass="btn btn-default btn-xs">
							<span class=" glyphicon glyphicon-edit"></span>
							<f:setPropertyActionListener value="#{despesa}"
								target="#{sv_cadastro_controller.despesa}" />
						</p:commandLink>

						<p:commandLink action="#{sv_cadastro_controller.removerDespesa()}"
							update="table-despesas" process="@this"
							style="margin-left:5px;font-size:12px;color:#fff"
							styleClass="btn btn-danger btn-xs">
							<span class=" glyphicon glyphicon-remove-circle"></span>
				 		<p:confirm header="Confirmação" message="Excluir despesa?"
								icon="ui-icon-alert" />
							<f:setPropertyActionListener value="#{despesa}"
								target="#{sv_cadastro_controller.despesa}" />
						</p:commandLink>
					</p:column>

				</p:dataTable>

			</p:panelGrid>

			<p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
				<p:commandButton value="Sim" type="button"
					styleClass="ui-confirmdialog-yes"
					onclick="PrimeFaces.monitorDownload(start, stop);"
					icon="ui-icon-check" />
				<p:commandButton value="Não" type="button"
					styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
			</p:confirmDialog>

		</h:form>
	</div>

	<style type="text/css">
.fonte_sv {
	font-size: 12px;
}
</style>
</ui:fragment>