<!DOCTYPE html>
<ui:composition template="/WEB-INF/LayoutFullPage.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
	xmlns:jsf="http://xmlns.jcp.org/jsf" xmlns:o="http://omnifaces.org/ui">


	
	<ui:define name="content">
		<f:metadata>
			<f:viewAction action="#{usuario_controller.init()}" />
			<o:viewParam name="id"
				value="#{usuario_controller.idUser}" />
		</f:metadata>
	
		<div class="container mt-3">
			<h:form id="formUsuario" acceptcharset="ISO-8859-1">
			
				<p:messages id="messages" showSummary="true" closable="true">
					<p:autoUpdate />
				</p:messages>
				
				<p:panel header="Cadastro de Usuário" prependId="false">

					<div class="row text-right">
						<div class="col form-group">
							<p:commandLink styleClass="btn btn-success btn-sm" type="button"
								action="#{usuario_controller.salvar()}" ajax="false"
								onclick="start()" onsuccess="stop()" onerror="stop()">
								<i class="fa fas fa-save"></i> Salvar</p:commandLink>
							<p:link outcome="/main/cadastro_usuarios_att"
								styleClass="btn btn-outline-dark btn-sm">
								<i class="fa fas fa-arrow-left"></i> Voltar</p:link>
						</div>
					</div>
					
					<div class="row">
						
						<div class="form-group col">
							<p:outputLabel value="Colaborador: " for="colaborador" />
							<p:autoComplete id="colaborador" style="width:100%;"
								requiredMessage="Colaborador é Obrigatório" rendered="true"
								placeholder="Nome" required="true"
								value="#{usuario_controller.usuario.colaborador}"
								completeMethod="#{usuario_controller.completeListColaborador}"
								var="colaborador" itemLabel="#{colaborador.nome}"
								itemValue="#{colaborador}" converter="colaboradorConverter"
								forceSelection="true">
								<p:ajax listener="#{usuario_controller.setFields()}" 
									update="email, gestao" event="itemSelect" />
							</p:autoComplete>
						</div>
						
						
					</div>
					
					<div class="row">
						<div class="form-group col">
							<p:outputLabel value="Email: " for="email" />
							<p:inputText id="email"
								value="#{usuario_controller.usuario.email}"
								placeholder="exemplo@fas-amazonas.org">
								<f:validateRegex
									pattern="^[_A-Za-z0-9-\+]+(\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\.[A-Za-z0-9]+)*(\.[A-Za-z]{2,})$" />
							</p:inputText>
						</div>
						<div class="col form-group">
							<p:outputLabel value="Gestão: " for="gestao" />
							<p:selectOneMenu id="gestao" filter="true"
								filterMatchMode="startsWith" style="width:100%"
								value="#{usuario_controller.usuario.colaborador.gestao}"
								converter="gestaoConverter" required="true">
								<f:selectItem noSelectionOption="true" />
								<f:selectItems value="#{usuario_controller.getListGestao()}"
									var="action" itemLabel="#{action.nome}" itemValue="#{action}" />
							</p:selectOneMenu>
						</div>					
					</div>
					<div class="row">
						<div class="col form-group">
							<p:outputLabel value="Perfil: " for="perfil"
								rendered="#{usuario_controller.poderEditar()}" />
							<p:selectOneMenu id="perfil" filter="true"
								filterMatchMode="startsWith" style="width:100%"
								value="#{usuario_controller.usuario.perfil}"
								converter="perfilConverter" required="true">
								<f:selectItem noSelectionOption="true" />
								<f:selectItems value="#{usuario_controller.listaPerfil()}"
									var="perfil" itemLabel="#{perfil.descricao}" itemValue="#{perfil}" />
							</p:selectOneMenu>
						</div>
		
						<div class="form-group col">
							<p:outputLabel value="Usuário: " for="username" />
							<p:inputText id="username" required="true"
								requiredMessage="O campo Usuário é obrigatório"
								value="#{usuario_controller.usuario.nomeUsuario}" />
						
						</div>
					</div>				
						
					

				</p:panel>
			</h:form>
		</div>
	</ui:define>
	<ui:define name="adicionais">
		<p:dialog modal="true" style="z-index:1000" widgetVar="statusDialog"
			showHeader="false" draggable="false" closable="false"
			resizable="false">
			<p:graphicImage library="image" name="aguarde.gif" />
			<p:graphicImage style="width:120px;height:70px" library="image"
				name="logofas.png" />
		</p:dialog>
	</ui:define>

</ui:composition>