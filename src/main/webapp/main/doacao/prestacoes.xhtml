<ui:fragment xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
	xmlns:jsf="http://xmlns.jcp.org/jsf">

	<p:panel id="panel-info-prestacoes">

		<p:outputPanel id="prestacao-multipla">
			<div id="info-prestacoes" class="ui-g ui-fluid">

				<div class="ui-g-3 form-group focused">

					<p:outputLabel value="Data de início da prestação:"
						for="input-dt-init" styleClass="form-label" />
					<p:calendar id="input-dt-init" placeholder="Data início"
						value="#{orcamento_controller.orcamento.dataPrestacao}"
						navigator="true" pattern="dd/MM/yyyy" />

				</div>

				<div class="ui-g-3 form-group focused">
					<p:outputLabel value="Tipo de Parcelamento: " for="input-type-pgto"
						styleClass="form-label" />
					<p:selectOneMenu id="input-type-pgto"
						value="#{orcamento_controller.orcamento.tipoParcelamento}">
						<f:selectItem itemLabel="Selecione um tipo de parcelamento"
							itemValue="" />
						<f:selectItems value="#{orcamento_controller.tiposParcelamento}"
							var="item" itemLabel="#{item.nome}" itemValue="#{item}" />
					</p:selectOneMenu>
				</div>

				<div class="ui-g-3 form-group focused">
					<p:outputLabel value="Número de parcelas:" for="input-quant-parcel"
						styleClass="form-label" />
					<p:inputMask id="input-quant-parcel" mask="9?9" size="5"
						value="#{orcamento_controller.orcamento.quantidadeParcelas}" />

				</div>

				<div class="ui-g-3">

					<p:commandLink styleClass="btn btn-primary btn-sm"
						style="margin-left:5px" title="Gerar Parcelas"
						process="@this,prestacao-multipla" onclick="start()"
						oncomplete="stop()" onerror="stop()"
						action="#{orcamento_controller.gerarPrestacoes()}"
						update="prestacoes">
						<i class="pi pi-check"></i>
						<span style="margin: 3px;">Gerar parcelas</span>
					</p:commandLink>

				</div>


			</div>
		</p:outputPanel>


		<div class="ui-g ui-fluid">


			<div class="ui-g-12">

				<p:dataTable id="prestacoes"
					value="#{orcamento_controller.orcamento.prestacoes}"
					var="prestacao" paginator="true" rows="5">
					<f:facet name="header">
				Lista de prestações
			</f:facet>

					<p:column headerText="Nº." width="30" style="text-align:right">
						<h:outputText value="#{prestacao.numero}" />
					</p:column>

					<p:column headerText="Data">
						<p:calendar styleClass="font12-vi" size="12"
							value="#{prestacao.data}" timeZone="America/Manaus"
							navigator="true" pattern="dd/MM/yyyy" />
					</p:column>

					<p:column headerText="Valor" style="text-align:right">
						<p:inputText value="#{prestacao.valor}"
							onkeydown="mascaraMoeda(this,moeda)" style="text-align: right;">
							<p:ajax event="blur" update="prestacoes"
								listener="#{orcamento_controller.recalcularPrestacoes(prestacao)}" />
							<f:convertNumber minFractionDigits="2" maxFractionDigits="2"
								locale="pt_BR" />
						</p:inputText>
					</p:column>

					<p:column style="width:40px;text-align:center">

						<p:commandLink style="color:#fff;margin-left:5px"
							onclick="start();" onerror="stop();"
							oncomplete="stop(); steping(1); "
							styleClass="btn btn-danger btn-xs"
							action="#{orcamento_controller.removerPrestacao()}"
							process="@this" update="prestacoes" title="Excluir prestação">

							<p:confirm header="Exclusão" message="Você deseja excluir?"
								icon="pi pi-exclamation-triangle" />
							<f:setPropertyActionListener value="#{prestacao}"
								target="#{orcamento_controller.prestacaoOrcamento}" />
							<span class="pi pi-times-circle"></span>

						</p:commandLink>


					</p:column>

					<p:columnGroup type="footer">
						<p:row>
							<p:column colspan="2" footerText="TOTAL: "
								style="text-align:right" />
							<p:column style="text-align:right"
								footerText="#{orcamento_controller.totalPrestacoes}" />

							<p:column style="text-align:right" />
						</p:row>
					</p:columnGroup>
				</p:dataTable>

			</div>


		</div>



	</p:panel>








</ui:fragment>