<!DOCTYPE html>
<ui:composition template="/WEB-INF/LayoutFullPage.xhtml"
				xmlns="http://www.w3.org/1999/xhtml"
				xmlns:f="http://xmlns.jcp.org/jsf/core"
				xmlns:h="http://xmlns.jcp.org/jsf/html"
				xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
				xmlns:p="http://primefaces.org/ui"
				xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
				xmlns:jsf="http://xmlns.jcp.org/jsf">

	<ui:define name="content">

		<script type="text/javascript">
			function start() {
				PF('statusDialog').show();
			}

			function stop() {
				PF('statusDialog').hide();
			}

			function stopDlgfilter() {
				PF('dlg_filtro_compra').hide();
			}
		</script>

		<f:metadata>
			<f:viewAction action="#{lancamentos_v2.init()}" />
		</f:metadata>

		<h:form>
			<p:breadCrumb>
				<p:menuitem value="Categories" url="home_new.xhtml" />
				<p:menuitem value="Lista de Lançamentos" />
			</p:breadCrumb>
		</h:form>
		<p:panel id="toggleable" header="Lançamentos" toggleable="true"
				 closable="false" toggleSpeed="500" closeSpeed="500" widgetVar="panel"
				 style="margin-bottom:20px">


			<h:form id="form-lancamento-pagamento">



				<p:messages showDetail="true" closable="true" autoUpdate="true"
							id="msg_lancamento"></p:messages>

				<p:panelGrid columns="4" styleClass="ui-noborder">
					<h:outputText value="Lançamento:" />
					<p:inputText placeholder="Nº lançamento" size="40"
								 value="#{lancamentos_v2.filtro.lancamentoID}" />

					<h:outputText value="Nº Documento Fiscal:" />
					<p:inputText placeholder="Nº Documento" size="40"
								 value="#{lancamentos_v2.filtro.numeroDocumento}" />

					<h:outputText value="Nº Documento:" />
					<p:inputText placeholder="Nº Adiantamento" size="40"
								 value="#{lancamentos_v2.filtro.numeroDocumentoAdiantemento}" />

					<h:outputText value="Período de Pgto:" />
					<h:panelGroup>
						<p:calendar size="10" value="#{lancamentos_v2.filtro.dataInicio}"
									navigator="true" timeZone="America/Manaus" pattern="dd/MM/yyyy" />
						-
						<p:calendar size="10" value="#{lancamentos_v2.filtro.dataFinal}"
									navigator="true" timeZone="America/Manaus" pattern="dd/MM/yyyy" />

					</h:panelGroup>

					<h:outputText value="Pagador:" />
					<p:autoComplete placeholder="Pagador" size="40"
									value="#{lancamentos_v2.filtro.pagador}"
									completeMethod="#{lancamentos_v2.completeConta}" var="conta"
									itemLabel="#{conta.nomeConta}" itemValue="#{conta}"
									converter="contaConverter" />

					<h:outputText value="Fornecedor:" />
					<p:autoComplete placeholder="Fornecedor" size="40"
									value="#{lancamentos_v2.filtro.fornecedor}"
									completeMethod="#{lancamentos_v2.completeConta}" var="conta"
									itemLabel="#{conta.nomeConta}" itemValue="#{conta}"
									converter="contaConverter" />


					<h:outputText value="Paríodo de Emissão:" />
					<h:panelGroup>
						<p:calendar size="10"
									value="#{lancamentos_v2.filtro.dataInicioEmissao}"
									navigator="true" timeZone="America/Manaus" pattern="dd/MM/yyyy" />
						-
						<p:calendar size="10"
									value="#{lancamentos_v2.filtro.dataFinalEmissao}"
									navigator="true" timeZone="America/Manaus" pattern="dd/MM/yyyy" />
					</h:panelGroup>



					<h:outputText value="Projeto:" />
					<p:autoComplete placeholder="Projeto" size="40"
									value="#{lancamentos_v2.filtro.projeto}"
									completeMethod="#{lancamentos_v2.completeProjetos}" var="projeto"
									itemLabel="#{projeto.nome}" itemValue="#{projeto}"
									converter="projetoConverter">

						<p:column>
							<h:outputText value="#{projeto.codigo}" />
						</p:column>

						<p:column>
							<h:outputText value="#{projeto.nome}" />
						</p:column>

					</p:autoComplete>

					<h:outputText value="Status:" />
					<p:selectOneMenu style="margin: 2px 2px;"
									 value="#{lancamentos_v2.filtro.statusPagamento}">
						<f:selectItem itemLabel="Status" noSelectionOption="true" />
						<f:selectItems value="#{pagamentoLancController.statusPagamento}"
									   var="stt" itemLabel="#{stt.nome}" itemValue="#{stt}" />
					</p:selectOneMenu>



				</p:panelGrid>

				<h:panelGroup>

					<p:commandLink styleClass="btn btn-primary btn-sm "
								   onstart="start()" onsuccess="stop()" onerror="stop()"
								   action="#{lancamentos_v2.carregarLancamentos()}"
								   update=":form-lancamento-pagamento:table-lancamentos"
								   style="color:#fff; margin: 8px 2px;">
						<i class="fa fa-search"></i>
						<span style="width: 40px; font-family: Arial">Buscar</span>
					</p:commandLink>

					<p:commandLink styleClass="btn btn-danger btn-sm "
								   title="Limpar" process="@this" onstart="start()"
								   onsuccess="stop()" onerror="stop()"
								   action="#{lancamentos_v2.limpar()}"
								   update=":form-lancamento-pagamento"
								   style="color:#fff; margin: 8px 2px;">
						<i class="fa fa-remove"></i>
						<span style="width: 40px; font-family: Arial">Limpar</span>
					</p:commandLink>

					<p:commandLink
							styleClass="btn  btn-success btn-sm "
							onstart="start()" onsuccess="stop()" onerror="stop()"
							action="#{lancamentos_v2.efetivarMultiplos()}"
							update=":form-lancamento-pagamento:table-lancamentos"
							style="color:#fff; margin: 8px 2px;">
						<i class="fa fa-check-square-o"></i>
						<span style="width: 40px; font-family: Arial">Efetivar</span>
					</p:commandLink>

					<p:commandLink styleClass="btn btn-warning btn-sm "
								   onstart="start()" onsuccess="stop()" onerror="stop()"
								   action="#{lancamentos_v2.desprovisionar()}"
								   update=":form-lancamento-pagamento:table-lancamentos"
								   style="color:#fff; margin: 8px 2px;">
						<i class="fa fa-mail-reply"></i>
						<span style="width: 40px; font-family: Arial">Desprovisionar</span>
					</p:commandLink>

					<p:commandLink styleClass="btn btn-warning btn-sm "
								   onstart="start()" onsuccess="stop()" onerror="stop()"
								   action="#{lancamentos_v2.removerLancamento()}" rendered="false"
								   update=":form-lancamento-pagamento:table-lancamentos"
								   style="color:#fff; margin: 8px 2px;">
						<p:confirm header="Confirmação" icon="ui-icon-alert"
								   message="Desejar excluir lançamento?" />
						<i class="fa fa-close"></i>
						<span style="width: 40px; font-family: Arial">Remover</span>
					</p:commandLink>

					<p:commandLink style="color:#fff; margin: 8px 2px;"
								   onstart="start()" onsuccess="stop()" onerror="stop()"
								   styleClass="btn btn-info btn-sm "
								   update=":form-edit-pagamento-data"
								   title="Editar Data de Pagamento"
								   oncomplete="PF('dialogAlteraDataPagamento').show()">
						<i class="fa fa-calendar"></i>
						<span style="width: 40px; font-family: Arial">Alterar Data</span>
					</p:commandLink>
				</h:panelGroup>

				<p:dataTable id="table-lancamentos"
							 rowKey="#{lancamento.idPagamento}"
							 selection="#{lancamentos_v2.lancamentosSelected}"
							 value="#{lancamentos_v2.lancamentos}" var="lancamento"
							 paginator="true" rows="10">


					<p:column selectionMode="multiple" style="width:35px" />

					<p:column headerText="Nº" style="width:50px;text-align:center">
						<h:outputText value="#{lancamento.codigoLancamento}" />
					</p:column>

					<p:column headerText="Nº Documento Fiscal"
							  style="width:80px;text-align:center">
						<h:outputText value="#{lancamento.numeroDocumento}" />
					</p:column>

					<p:column headerText="Nº Adiantamento"
							  style="width:80px;text-align:center">
						<h:outputText value="#{lancamento.idAdiantamentoDePrestacao}" />
					</p:column>

					<p:column headerText="Emissão" style="width:80px;text-align:center">
						<h:outputText value="#{lancamento.dataEmissao}">
							<f:convertDateTime pattern="dd/MM/yyyy" timeZone="America/Manaus" />
						</h:outputText>
					</p:column>


					<p:column headerText="Pagamento"
							  style="width:80px;text-align:center">
						<h:outputText value="#{lancamento.dataPagamento}">
							<f:convertDateTime pattern="dd/MM/yyyy" timeZone="America/Manaus" />
						</h:outputText>
					</p:column>

					<p:column headerText="Pagador"
							  style="width:100px;text-align:center">
						<h:outputText value="#{lancamento.contaPagadorLbl}" />
					</p:column>

					<p:column headerText="Fornecedor"
							  style="width:100px;text-align:center">
						<h:outputText value="#{lancamento.contaRecebedorLbl}" />
					</p:column>

					<p:column headerText="Fonte de recurso"
							  style="width:150px;text-align:center">
						<h:outputText value="#{lancamento.fonte}" />
					</p:column>

					<p:column headerText="Projeto"
							  style="width:150px;text-align:center">
						<h:outputText value="#{lancamento.nomeProjeto}" />
					</p:column>

					<p:column headerText="Descrição"
							  style="width:150px;text-align:center">
						<h:outputText value="#{lancamento.descricao}" />
					</p:column>

					<p:column headerText="Status" style="width:100px;text-align:center">
						<h:outputText value="#{lancamento.status}" />
					</p:column>

					<p:column headerText="Valor lançamento"
							  style="width:70px;text-align:center">
						<h:outputText value="#{lancamento.valorLancamento}">
							<f:convertNumber type="currency" locale="pt_BR" />
						</h:outputText>
					</p:column>

					<p:column headerText="Valor pago"
							  style="width:70px;text-align:center">
						<h:outputText value="#{lancamento.valorPagoAcao}">
							<f:convertNumber type="currency" locale="pt_BR" />
						</h:outputText>
					</p:column>

					<p:column headerText="Opções" style="width:160px;text-align:center">
						<p:commandLink style="margin-right:5px" onstart="start()"
									   onsuccess="stop()" onerror="stop()"
									   styleClass="btn btn-default btn-xs"
									   update=":form-edit-pagamento-tab2" title="Editar pagamento"
									   oncomplete="PF('dlg_edt_pagamento_tab2').show()"
									   action="#{lancamentos_v2.prepararEdicao(lancamento.idPagamento)}">
							<i class="fa fa-pencil-square-o"></i>
						</p:commandLink>

						<p:commandLink style="margin-right:5px" onstart="start()"
									   onsuccess="stop()" onerror="stop()" title="Gerar tarifa"
									   styleClass="btn btn-default btn-xs"
									   update=":form-tarifa"
									   action="#{lancamentos_v2.prepararTarifa(lancamento.idPagamento)}"
									   oncomplete="PF('dlg_gerardor_tarifa').show()">
							<i class="fa fa-usd"></i>
						</p:commandLink>


						<p:commandLink title="Termo de doação"
									   styleClass="btn btn-default btn-xs"
									   target="_blank" style="color:#000;margin-right:5px"
									   update="panel-content" ajax="false"
									   action="#{lancamentos_v2.imprimirTermo(lancamento.idTermo)}">
							<i class="fa fa-file"></i>
						</p:commandLink>


						<p:commandLink title="Documentos"
									   styleClass="btn btn-default btn-xs"
									   target="_blank" style="color:#000;margin-right:5px"
									   process="@this" oncomplete="PF('dialog_arquivo').show();"
									   update=":form-arquivo"
									   action="#{lancamentos_v2.carregarArquivos(lancamento.codigoLancamento)}">
							<i class="fa fa-file"></i>
						</p:commandLink>


					</p:column>





				</p:dataTable>


			</h:form>

		</p:panel>
		<p:separator />
	</ui:define>

	<ui:define name="adicionais">

		<p:dialog header="Anexos" modal="true" widgetVar="dialog_arquivo"
				  width="60%" hideEffect="clip" closeOnEscape="true" showEffect="clip">

			<h:form id="form-arquivo" enctype="multipart/form-data">
				<p:messages id="msg_aprouve" autoUpdate="false" showIcon="true"
							showSummary="false" showDetail="true" closable="true" />
				<p:panelGrid columns="1">
					<p:remoteCommand name="salvar"
									 action="#{lancamentos_v2.adicionarArquivo()}"
									 process="form-arquivo"
									 update="table-arquivo form-arquivo panel_grid" />



					<p:panelGrid id="panel_grid" columns="4" styleClass="ui-fluid"
								 style="width:100%">
						<h:outputLabel value="Descrição:" />
						<h:panelGroup>
							<p:inputText id="input_name_arq"
										 value="#{lancamentos_v2.arquivo.nome}" />
							<p:tooltip for="input_name_arq"
									   value="Adicione um nome para que
								possamos achar com facilidade o anexo,
								adicione o número do lançamento antes do nome
								ex: Pedido 19009  o anexo ficaria '19009-Autor. Pagto. NF - 00888' "
									   position="top" />
						</h:panelGroup>

						<h:outputLabel value="Tipo:" />
						<p:selectOneMenu value="#{lancamentos_v2.arquivo.tipo}">
							<f:selectItem itemLabel="Selecione o tipo"
										  noSelectionOption="true" />
							<f:selectItems value="#{lancamentos_v2.tipos}" var="tipo"
										   itemLabel="#{tipo.nome}" itemValue="#{tipo}" />
						</p:selectOneMenu>

						<h:panelGroup rendered="false">
							<p:commandLink id="btn_add_arq"
										   action="#{lancamentos_v2.adicionarArquivo()}"
										   process="form-arquivo" style="color:#000"
										   update="table-arquivo form-arquivo"
										   styleClass="btn btn-default btn-xs glyphicon glyphicon-check" />
							<p:tooltip id="toolTipGrow" for="btn_add_arq"
									   value="Salvar na lista de arquivos" position="top" />
						</h:panelGroup>


					</p:panelGrid>

					<p:fileUpload label="Procurar" cancelLabel="Cancelar"
								  uploadLabel="Salvar" oncomplete="salvar()"
								  update="table-arquivo form-arquivo panel_grid"
								  fileUploadListener="#{lancamentos_v2.handleFileUpload}"
								  mode="advanced" process="form-arquivo:panel_grid"
								  skinSimple="true" dragDropSupport="false" sizeLimit="100000000"
								  allowTypes="/(\.|\/)(pdf)$/" />

					<p:dataTable id="table-arquivo" styleClass="ui-fluid"
								 paginator="true" rows="4"
								 value="#{lancamentos_v2.lancamento.arquivos}" var="arq">
						<p:column headerText="Nome" filterBy="#{arq.nome}"
								  filterMatchMode="contains">
							<h:outputText value="#{arq.nome}" />
						</p:column>

						<p:column style="width:100px">
							<p:commandLink id="btn_visualizar" style="color:#000"
										   styleClass="btn btn-default btn-xs glyphicon glyphicon-search"
										   action="#{lancamentos_v2.visualizarArquivo()}" target="_blank"
										   ajax="false" process="@this">
								<f:setPropertyActionListener value="#{arq}"
															 target="#{lancamentos_v2.arqAuxiliar}" />
							</p:commandLink>
							<p:tooltip for="btn_visualizar" value="Visualisar anexo"
									   position="top" />

							<p:commandLink id="btn_excluir"
										   style="color:#000;margin-left:9px" onclick="start()"
										   onerror="stop()" oncomplete="stop()"
										   styleClass="btn btn-default btn-xs glyphicon glyphicon-remove-circle"
										   action="#{lancamentos_v2.removerArquivo()}" process="@this"
										   update="table-arquivo :form-arquivo:msg_aprouve">
								<f:setPropertyActionListener value="#{arq}"
															 target="#{lancamentos_v2.arqAuxiliar}" />
								<p:confirm header="Confirmação" icon="ui-icon-alert"
										   message="Desejar excluir documento?" />
							</p:commandLink>
							<p:tooltip for="btn_excluir" value="Excluir anexo" position="top" />

						</p:column>

					</p:dataTable>

				</p:panelGrid>
			</h:form>

		</p:dialog>



		<p:dialog widgetVar="dlg_gerardor_tarifa" closable="true" width="50%"
				  resizable="true" header="Geração de tarifas" showEffect="clip"
				  hideEffect="clip">

			<h:form id="form-tarifa">
				<p:panelGrid columns="2" style="width:100%" styleClass="ui-fluid">
					<h:outputText value="Pagador:" style="float:right" />
					<h:outputText
							value="#{lancamentos_v2.tarifa.contaPagador.nomeConta}" />

					<h:outputText value="Recebedor:" style="float:right" />
					<h:outputText
							value="#{lancamentos_v2.tarifa.contaRecebedor.nomeConta}" />


					<h:outputText value="Doação:" style="float:right" />
					<h:outputText
							rendered="#{lancamentos_v2.tipoTarifa.equals('projeto')}"
							value="#{lancamentos_v2.tarifa.lancamentosAcoes.get(0).projetoRubrica.rubricaOrcamento.orcamento.titulo}" />

					<h:outputText
							rendered="#{lancamentos_v2.tipoTarifa.equals('doacao')}"
							value="#{lancamentos_v2.tarifa.lancamentosAcoes.get(0).rubricaOrcamento.orcamento.titulo}" />

					<h:outputText value="Componente:" style="float:right" />
					<h:outputText
							rendered="#{lancamentos_v2.tipoTarifa.equals('projeto')}"
							value="#{lancamentos_v2.tarifa.lancamentosAcoes.get(0).projetoRubrica.rubricaOrcamento.componente.nome}" />

					<h:outputText
							rendered="#{lancamentos_v2.tipoTarifa.equals('doacao')}"
							value="#{lancamentos_v2.tarifa.lancamentosAcoes.get(0).rubricaOrcamento.componente.nome}" />

					<h:outputText value="Subcomponente:" style="float:right" />
					<h:outputText
							rendered="#{lancamentos_v2.tipoTarifa.equals('projeto')}"
							value="#{lancamentos_v2.tarifa.lancamentosAcoes.get(0).projetoRubrica.rubricaOrcamento.subComponente.nome}" />

					<h:outputText
							rendered="#{lancamentos_v2.tipoTarifa.equals('doacao')}"
							value="#{lancamentos_v2.tarifa.lancamentosAcoes.get(0).rubricaOrcamento.subComponente.nome}" />


					<h:outputText value="Linha orçamentária:" style="float:right" />
					<h:outputText
							rendered="#{lancamentos_v2.tipoTarifa.equals('projeto')}"
							value="#{lancamentos_v2.tarifa.lancamentosAcoes.get(0).projetoRubrica.rubricaOrcamento.rubrica.nome}" />

					<h:outputText
							rendered="#{lancamentos_v2.tipoTarifa.equals('doacao')}"
							value="#{lancamentos_v2.tarifa.lancamentosAcoes.get(0).rubricaOrcamento.rubrica.nome}" />


					<h:outputText value="Valor:" style="float:right" />
					<h:outputText
							value="#{lancamentos_v2.tarifa.valorTotalComDesconto}">
						<f:convertNumber type="currency" maxFractionDigits="2"
										 currencySymbol="R$" />

					</h:outputText>
				</p:panelGrid>

				<p:separator />

				<p:commandLink styleClass="btn btn-primary btn-sm"
							   action="#{lancamentos_v2.salvarTarifa()}" onclick="start()"
							   onerror="stop()"
							   oncomplete="stop();PF('dlg_gerardor_tarifa').hide()"
							   update=":form-lancamento-pagamento :form-lancamento-pagamento:msg_lancamento"
							   style="color:#fff; margin: 2px 2px;">
					<span style="font-family: Arial;">Salvar</span>
				</p:commandLink>

			</h:form>
		</p:dialog>


		<p:dialog widgetVar="dlg_edt_pagamento_tab2" closable="true"
				  modal="true" resizable="true" header="Pagamento" showEffect="clip"
				  hideEffect="clip">
			<h:form id="form-edit-pagamento-tab2">
				<p:messages showDetail="true" closable="true" autoUpdate="true"
							id="msg_lancamento"></p:messages>
				<p:panelGrid columns="2">

					<p:panelGrid columns="2">

						<f:facet name="header">
							<p:outputLabel value="Informações gerais"></p:outputLabel>
						</f:facet>

						<p:outputLabel value="Lançamento:" />
						<h:outputText
								value="#{lancamentos_v2.pagamentoLancAuxiliar.lancamentoAcao.lancamento.id}" />

						<p:outputLabel value="Categoria:" />
						<p:selectOneMenu style="font-size:12px" filter="true"
										 filterMatchMode="contains" converter="categoriaFinConverter"
										 value="#{lancamentos_v2.pagamentoLancAuxiliar.lancamentoAcao.lancamento.categoriaFinanceira}">
							<f:selectItem noSelectionOption="true" />
							<f:selectItems value="#{lancamentos_v2.listCategoriaFinanceira}"
										   var="categoria" itemLabel="#{categoria.nome}"
										   itemValue="#{categoria}" />

						</p:selectOneMenu>

						<p:outputLabel value="Conta:" />
						<p:autoComplete id="conta_banco" placeholder="Conta" size="40"
										value="#{lancamentos_v2.pagamentoLancAuxiliar.conta}"
										completeMethod="#{lancamentos_v2.completeConta}" var="conta"
										itemLabel="#{conta.nomeConta}" itemValue="#{conta}"
										converter="contaConverter" />

						<p:outputLabel value="N° Nota:" />
						<p:inputText
								value="#{lancamentos_v2.pagamentoLancAuxiliar.lancamentoAcao.lancamento.notaFiscal}" />



						<p:outputLabel value="Data:" />
						<p:calendar navigator="true"
									value="#{lancamentos_v2.pagamentoLancAuxiliar.dataPagamento}"
									timeZone="America/Manaus" pattern="dd/MM/yyyy" />

						<p:outputLabel value="Valor:" />
						<p:inputText value="#{lancamentos_v2.pagamentoLancAuxiliar.valor}"
									 onkeypress="return formatarNumero(this,event,19,2);">
							<f:convertNumber minFractionDigits="2" maxFractionDigits="2"
											 locale="pt_BR" />
						</p:inputText>

					</p:panelGrid>


					<p:panelGrid columns="2" rendered="#{lancamentos_v2.editarLinha}">

						<f:facet name="header">
							<p:outputLabel value="Edição Recursos"></p:outputLabel>
						</f:facet>


						<p:outputLabel value="Linhas orçamentárias:"
									   rendered="#{lancamentos_v2.pagamentoLancAuxiliar.lancamentoAcao.rubricaOrcamento != null}" />
						<p:autoComplete id="cate_compra_edit" placeholder="Categoria"
										size="40"
										rendered="#{lancamentos_v2.pagamentoLancAuxiliar.lancamentoAcao.rubricaOrcamento != null}"
										value="#{lancamentos_v2.pagamentoLancAuxiliar.lancamentoAcao.rubricaOrcamento}"
										completeMethod="#{custo_pessoal_controller.completeRubricasDeOrcamento}"
										var="categoria" itemLabel="#{categoria.rubrica.nome}"
										itemValue="#{categoria}" converter="rubricaOrcamentoConverter">

							<p:column headerText="Doação">
								<h:outputText value="#{categoria.orcamento.fonte.nome}" />
							</p:column>

							<p:column headerText="Doação">
								<h:outputText value="#{categoria.orcamento.titulo}" />
							</p:column>

							<p:column headerText="Componente">
								<h:outputText value="#{categoria.componente.nome}" />
							</p:column>

							<p:column headerText="SubComponente">
								<h:outputText value="#{categoria.subComponente.nome}" />
							</p:column>

							<p:column headerText="Categoria">
								<h:outputText value="#{categoria.rubrica.nome}" />
							</p:column>

						</p:autoComplete>
						<p:separator></p:separator>
						<p:separator></p:separator>


						<h:outputText value="Projetos:"
									  rendered="#{lancamentos_v2.pagamentoLancAuxiliar.lancamentoAcao.projetoRubrica != null}" />
						<p:selectOneMenu value="#{lancamentos_v2.projetoAux}"
										 style="width:160px" filter="true" filterMatchMode="contains"
										 rendered="#{lancamentos_v2.pagamentoLancAuxiliar.lancamentoAcao.projetoRubrica != null}">
							<f:selectItem noSelectionOption="true" />
							<f:selectItems value="#{lancamentos_v2.listaProjeto}"
										   var="projeto" itemLabel="#{projeto.nome}" itemValue="#{projeto}" />
							<p:ajax update="lbl_linha linha_orcament" onstart="start()"
									onerror="stop()" onsuccess="stop()"
									listener="#{lancamentos_v2.listaRubricas()}" />
						</p:selectOneMenu>


						<h:outputText id="lbl_linha" value="Linha orçamentária:"
									  rendered="#{lancamentos_v2.projetoAux != null}" />

						<p:selectOneMenu id="linha_orcament" style="width:160px"
										 rendered="#{lancamentos_v2.projetoAux != null}"
										 placeholder="Entre com o código/nome do projeto." size="25"
										 value="#{lancamentos_v2.pagamentoLancAuxiliar.lancamentoAcao.projetoRubrica}"
										 filter="true" filterMatchMode="contains" var="categoria"
										 converter="projetoRubricaConverter">

							<f:selectItems value="#{lancamentos_v2.listaDeRubricasProjeto}"
										   var="ru" itemLabel="#{ru.nomeCategoria}" itemValue="#{ru}" />


							<p:column headerText="Código">
								<h:outputText value="#{categoria.codigo}" />
							</p:column>

							<p:column headerText="Fonte">
								<h:outputText value="#{categoria.nomeFonte}" />
							</p:column>

							<p:column headerText="Projeto">
								<h:outputText value="#{categoria.nomeProjeto}" />
							</p:column>

							<p:column headerText="Componente">
								<h:outputText value="#{categoria.nomeComponente}" />
							</p:column>

							<p:column headerText="SubComponente">
								<h:outputText value="#{categoria.nomeSubComponente}" />
							</p:column>

							<p:column headerText="Linha orçamentária">
								<h:outputText value="#{categoria.nomeCategoria}" />
							</p:column>

							<p:column headerText="Saldo">
								<h:outputText value="#{categoria.valorSaldo}">
									<f:convertNumber currencySymbol="R$:" minFractionDigits="2"
													 maxFractionDigits="2" locale="pt_BR" />
								</h:outputText>
							</p:column>


						</p:selectOneMenu>


						<p:outputLabel value="Descrição:" />
						<p:inputTextarea cols="50"
										 value="#{lancamentos_v2.pagamentoLancAuxiliar.lancamentoAcao.lancamento.descricao}" />

					</p:panelGrid>



					<p:panelGrid columns="2" rendered="#{!lancamentos_v2.editarLinha}">

						<f:facet name="header">
							<p:outputLabel value="Recursos"></p:outputLabel>
						</f:facet>


						<p:outputLabel value="Linhas orçamentárias:"
									   rendered="#{lancamentos_v2.pagamentoLancAuxiliar.lancamentoAcao.rubricaOrcamento != null}" />
						<p:autoComplete id="cate_compra" placeholder="Categoria" size="40"
										rendered="#{lancamentos_v2.pagamentoLancAuxiliar.lancamentoAcao.rubricaOrcamento != null}"
										value="#{lancamentos_v2.pagamentoLancAuxiliar.lancamentoAcao.rubricaOrcamento}"
										completeMethod="#{custo_pessoal_controller.completeRubricasDeOrcamento}"
										var="categoria" itemLabel="#{categoria.rubrica.nome}"
										itemValue="#{categoria}" converter="rubricaOrcamentoConverter">

							<p:column headerText="Doação">
								<h:outputText value="#{categoria.orcamento.fonte.nome}" />
							</p:column>

							<p:column headerText="Doação">
								<h:outputText value="#{categoria.orcamento.titulo}" />
							</p:column>

							<p:column headerText="Componente">
								<h:outputText value="#{categoria.componente.nome}" />
							</p:column>

							<p:column headerText="SubComponente">
								<h:outputText value="#{categoria.subComponente.nome}" />
							</p:column>

							<p:column headerText="Categoria">
								<h:outputText value="#{categoria.rubrica.nome}" />
							</p:column>

						</p:autoComplete>


						<h:outputText value="Fonte:" rendered="#{lancamentos_v2.pagamentoLancAuxiliar.lancamentoAcao.projetoRubrica != null}"/>
						<h:outputText rendered="#{lancamentos_v2.pagamentoLancAuxiliar.lancamentoAcao.projetoRubrica != null}"
									  value="#{lancamentos_v2.pagamentoLancAuxiliar.lancamentoAcao.projetoRubrica.rubricaOrcamento.orcamento.fonte.nome}" />

						<h:outputText value="Doação:" rendered="#{lancamentos_v2.pagamentoLancAuxiliar.lancamentoAcao.projetoRubrica != null}"/>
						<h:outputText rendered="#{lancamentos_v2.pagamentoLancAuxiliar.lancamentoAcao.projetoRubrica != null}"
									  value="#{lancamentos_v2.pagamentoLancAuxiliar.lancamentoAcao.projetoRubrica.rubricaOrcamento.orcamento.titulo}" />

						<h:outputText value="Projeto:" rendered="#{lancamentos_v2.pagamentoLancAuxiliar.lancamentoAcao.projetoRubrica != null}"/>
						<h:outputText rendered="#{lancamentos_v2.pagamentoLancAuxiliar.lancamentoAcao.projetoRubrica != null}"
									  value="#{lancamentos_v2.pagamentoLancAuxiliar.lancamentoAcao.projetoRubrica.projeto.nome}" />

						<h:outputText value="Linha:" rendered="#{lancamentos_v2.pagamentoLancAuxiliar.lancamentoAcao.projetoRubrica != null}"/>
						<h:outputText rendered="#{lancamentos_v2.pagamentoLancAuxiliar.lancamentoAcao.projetoRubrica != null}"
									  value="#{lancamentos_v2.pagamentoLancAuxiliar.lancamentoAcao.projetoRubrica.rubricaOrcamento.rubrica.nome}" />


						<p:outputLabel value="Descrição:" />
						<p:inputTextarea cols="50"
										 value="#{lancamentos_v2.pagamentoLancAuxiliar.lancamentoAcao.lancamento.descricao}" />

					</p:panelGrid>

				</p:panelGrid>
				<p:separator />
				<p:commandLink style="color:#fff"  onstart="start()"
							   onsuccess="stop()" onerror="stop()"
							   update=":form-lancamento-pagamento"
							   process="form-edit-pagamento-tab2"
							   styleClass="btn btn-primary btn-default btn-sm"
							   action="#{lancamentos_v2.editarPagamentoTab2()}">
					<i class="fa fa-check-square-o"></i>
					<span style="width: 40px; font-family: Arial">Salvar</span>
				</p:commandLink>

				<p:commandLink style="color:#fff;margin-left:5px"
							   rendered="#{!lancamentos_v2.editarLinha}" onstart="start()"
							   onsuccess="stop()" onerror="stop()"
							   update=":form-lancamento-pagamento form-edit-pagamento-tab2"
							   process="form-edit-pagamento-tab2"
							   styleClass="btn btn-primary btn-default btn-sm"
							   action="#{lancamentos_v2.changeMode()}">

					<i class="fa fa-check-square-o"></i>
					<span style="width: 40px; font-family: Arial">Editar linha</span>
				</p:commandLink>

				<p:commandLink style="color:#fff;margin-left:5px"
							   rendered="#{lancamentos_v2.editarLinha}" onstart="start()"
							   onsuccess="stop()" onerror="stop()"
							   update=":form-lancamento-pagamento form-edit-pagamento-tab2"
							   process="form-edit-pagamento-tab2"
							   styleClass="btn btn-danger btn-default btn-sm fa fa-close"
							   action="#{lancamentos_v2.changeMode()}">
					<span style="width: 40px; font-family: Arial">Cancelar
						edição</span>
				</p:commandLink>


			</h:form>
		</p:dialog>

		<p:dialog widgetVar="pagamentoConta" header="Pagamento"
				  closable="true" width="700" modal="true" showEffect="clip"
				  hideEffect="clip" resizable="false">

			<h:form id="form-pagamento">
				<p:messages showIcon="true" showSummary="false" showDetail="true" />
				<p:panelGrid columns="2">
					<p:panelGrid columns="2">
						<p:outputLabel value="Tipo:" />
						<p:selectOneMenu
								value="#{lancamentos_v2.pagamento.tipoParcelamento}">

							<f:selectItems value="#{lancamentos_v2.parcelamentos}"
										   var="parcelamento" itemValue="#{parcelamento}"
										   itemLabel="#{parcelamento.nome}" />
						</p:selectOneMenu>

						<p:outputLabel value="Nº Parcelas:" />
						<p:inputText value="#{lancamentos_v2.pagamento.quantidadeParcela}"
									 style="width:40px" />


						<p:outputLabel value="Conta:" />
						<p:selectOneMenu filter="true" filterMatchMode="contains"
										 value="#{lancamentos_v2.pagamento.conta}"
										 converter="contaConverter">
							<f:selectItems value="#{lancamentos_v2.contas}" var="conta"
										   itemValue="#{conta}" itemLabel="#{conta.nomeConta}" />
						</p:selectOneMenu>

						<p:outputLabel value="Pagamento:" />
						<p:calendar navigator="true"
									value="#{lancamentos_v2.pagamento.dataPagamento}"
									timeZone="America/Manaus" pattern="dd/MM/yyyy">
						</p:calendar>

						<p:outputLabel value="Valor:" />
						<p:inputText placeholder="Valor" required="true"
									 requiredMessage="Preencha o campo Valor."
									 onkeypress="return formatarNumero(this,event,19,2);"
									 value="#{lancamentos_v2.pagamento.valor}"
									 style="width:150px;margin-left:5px">
							<f:convertNumber minFractionDigits="2" maxFractionDigits="2"
											 locale="pt_BR" />
						</p:inputText>


						<p:commandLink styleClass="btn btn-primary"
									   action="#{lancamentos_v2.salvarPagamento()}"
									   update="totais :form-pagamento"
									   style="color:#fff;margin-left:5px;" value="Enviar" />

					</p:panelGrid>

					<p:panelGrid id="totais" columns="2">

						<p:outputLabel value="Total a pagar:" />
						<p:inputText id="total-a-pagar" disabled="true"
									 value="#{lancamentos_v2.totalApagar}">
							<f:convertNumber minFractionDigits="2" maxFractionDigits="2"
											 locale="pt_BR" />
						</p:inputText>

						<p:outputLabel value="Total pago:" />
						<p:inputText id="total-pago" disabled="true" style="color:'red'"
									 value="#{lancamentos_v2.totalPago}">
							<f:convertNumber minFractionDigits="2" maxFractionDigits="2"
											 locale="pt_BR" />
						</p:inputText>

						<p:outputLabel id="total-falta" value="Falta pagar:" />
						<p:inputText disabled="true"
									 value="#{lancamentos_v2.totalFaltaPagar}">
							<f:convertNumber minFractionDigits="2" maxFractionDigits="2"
											 locale="pt_BR" />
						</p:inputText>
					</p:panelGrid>

				</p:panelGrid>

				<p:dataTable value="#{lancamentos_v2.pagamentos}" var="pagamento">

					<p:column headerText="Conta">
						<h:outputText value="#{pagamento.conta.nomeConta}" />
					</p:column>

					<p:column headerText="Valor">
						<h:outputText value="#{pagamento.valor}">
							<f:convertNumber type="currency" locale="pt_BR" />
						</h:outputText>
					</p:column>

					<p:column headerText="Emissão">
						<h:outputText value="#{pagamento.dataEmissao}">
							<f:convertDateTime pattern="dd/MM/yyyy" timeZone="America/Manaus" />
						</h:outputText>
					</p:column>

					<p:column headerText="Pagamento">
						<h:outputText value="#{pagamento.dataPagamento}">
							<f:convertDateTime pattern="dd/MM/yyyy" timeZone="America/Manaus" />
						</h:outputText>
					</p:column>

					<p:column>
						<p:commandLink style="margin-right:5px" value="editar"
									   process="@this" onclick="PF('dlg_edt_pagamento').show()"
									   update=":form-edit-pagamento">
							<f:setPropertyActionListener value="#{pagamento}"
														 target="#{lancamentos_v2.pagamentoLancAuxiliar}" />
						</p:commandLink>

						<p:commandLink value="excluir" process="@this"
									   action="#{lancamentos_v2.removerPagamento()}"
									   update=":form-pagamento">
							<p:confirm header="Confirmação" icon="ui-icon-alert"
									   message="Desejar excluir pagamento?" />
							<f:setPropertyActionListener value="#{pagamento}"
														 target="#{lancamentos_v2.pagamento}" />
						</p:commandLink>
					</p:column>

				</p:dataTable>

				<p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
					<p:commandButton value="Sim" type="button"
									 styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
					<p:commandButton value="Não" type="button"
									 styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
				</p:confirmDialog>

			</h:form>
		</p:dialog>

		<p:dialog widgetVar="dlg_edt_pagamento" closable="true"
				  resizable="true" header="Pagamento" showEffect="clip"
				  hideEffect="clip">
			<h:form id="form-edit-pagamento">
				<p:panelGrid columns="2">
					<p:outputLabel value="Lançamento:" />
					<h:outputText
							value="#{lancamentos_v2.pagamentoLancAuxiliar.lancamentoAcao.lancamento.id}" />

					<p:outputLabel value="Data:" />
					<p:calendar navigator="true"
								value="#{lancamentos_v2.pagamentoLancAuxiliar.dataPagamento}"
								timeZone="America/Manaus" pattern="dd/MM/yyyy" />

					<p:outputLabel value="Valor:" />
					<p:inputText value="#{lancamentos_v2.pagamentoLancAuxiliar.valor}">
						<f:convertNumber type="currency" locale="pt_BR" />
					</p:inputText>
				</p:panelGrid>
				<p:separator />
				<p:commandLink style="color:#fff" value="Salvar"
							   update=":form-pagamento" styleClass="btn btn-primary btn-default"
							   action="#{lancamentos_v2.editarPagamento()}"
							   oncomplete="PF('dlg_edt_pagamento').hide()" />
			</h:form>
		</p:dialog>

		<p:dialog modal="true" style="z-index:1000" widgetVar="statusDialog"
				  showHeader="false" draggable="false" closable="false"
				  resizable="false">
			<p:graphicImage library="image" name="aguarde.gif" />
			<p:graphicImage style="width:120px;height:70px" library="image"
							name="logofas.png" />
		</p:dialog>

		<p:dialog widgetVar="dialogAlteraDataPagamento" closable="true"
				  resizable="false" header="Pagamento" showEffect="clip" modal="true"
				  hideEffect="clip">
			<h:form id="form-edit-pagamento-data">
				<p:panelGrid columns="2">


					<p:outputLabel value="Data:" />
					<p:calendar navigator="true"
								value="#{lancamentos_v2.dataAuxiliarAlteracaoEmMassa}"
								timeZone="America/Manaus" pattern="dd/MM/yyyy" />


				</p:panelGrid>
				<p:separator />
				<p:commandLink style="color:#fff" value="Salvar"
							   update=":form-lancamento-pagamento"
							   process="form-edit-pagamento-data"
							   styleClass="btn btn-primary btn-default"
							   action="#{lancamentos_v2.salvaAlteracaoData()}"
							   oncomplete="PF('dialogAlteraDataPagamento').hide()" />
			</h:form>
		</p:dialog>


		<p:dialog header="Mudança de Status" widgetVar="dialogAlterarStatus"
				  modal="false" resizable="false" showEffect="clip" hideEffect="clip">
			<div class="ui-fluid">
				<h:form id="formDialogAlterarStatus">

					<p:panelGrid columns="1" layout="grid">


						<p:selectOneMenu
								value="#{lancamentos_v2.lancamentoMudarStatus.statusCompra}"
								filter="true" filterMatchMode="contains">
							<f:selectItems value="#{lancamentos_v2.status}" var="status"
										   itemLabel="#{status.nome}" itemValue="#{status}" />
						</p:selectOneMenu>



					</p:panelGrid>
					<center>
						<div class="botao_central" align="left">
							<p:commandLink styleClass="btn btn-primary btn-sm" ajax="false"
										   action="#{lancamentos_v2.mudarStatusLancamento()}"
										   onclick="start()" onsuccess="stop()" onerror="stop()"
										   oncomplete="PF('dialogAlterarStatus').hide()"
										   style="color:#fff; margin: 8px 2px;">
								Salvar
							</p:commandLink>

							<p:commandLink styleClass="btn btn-primary btn-sm"
										   action="#{lancamentos_v2.carregarLancamentos()}"
										   onclick="PF('dialogAlterarStatus').hide()" ajax="false"
										   process="@this" style="color:#fff; margin: 8px 2px;">
								Cancelar
							</p:commandLink>

						</div>
					</center>
				</h:form>
			</div>
		</p:dialog>


	</ui:define>


</ui:composition>