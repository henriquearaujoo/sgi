<!DOCTYPE html>
<ui:composition template="/WEB-INF/LayoutFullPage.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
	xmlns:jsf="http://xmlns.jcp.org/jsf">





	<ui:define name="content">

		<f:metadata>
			<f:viewAction
				action="#{custo_pessoal_controller.initListagemReembolso()}" />
		</f:metadata>

		<script type="text/javascript">
			function start() {
			    PF('statusDialog').show();
			}
			 
			function stop() {
			    PF('statusDialog').hide();
			}
			
			function stopDlgfilter() {
			    PF('dlg_filtro_compra').hide();
			}
		</script>

		<h:form id="cadastro_reembolso">
			<p:messages  showSummary="false" showDetail="true"
				showIcon="true" closable="true" />
			<p:breadCrumb class="breadcrumb-container">


				<p:menuitem value="Categories" url="home_new.xhtml" />
				<p:menuitem value="Custo de pessoal" url="custo_pessoal.xhtml" />
				<p:menuitem value="Reembolsos de custo pessoal"
					url="reembolso_custo.xhtml" />
			</p:breadCrumb>

			<p:panel id="toggleable_custo_pessoal" header="Filtro"
				toggleable="true" collapsed="false" closable="false"
				toggleSpeed="500" closeSpeed="500" widgetVar="panel_custo_pessoal"
				style="margin-bottom:20px;">

				<p:panelGrid columns="2">
					<h:outputText value="Competência:" />
					<p:inputText value="#{custo_pessoal_controller.filtro.competencia}" />
				</p:panelGrid>

				<div class="botao_central" align="left"
					style="width: 100%; background-color: rgba(255, 255, 255, 0.18);">

					<p:commandLink styleClass="btn btn-primary btn-sm"
						action="#{custo_pessoal_controller.filtrarReembolso()}"
						onclick="start()" onsuccess="stop()" onerror="stop()"
						update="cadastro_reembolso" style="color:#fff; margin: 8px 2px;">
						<span class="glyphicon glyphicon-search" ></span><span  style="margin: 3px;">Procurar</span>
					</p:commandLink>

					<p:commandLink styleClass="btn btn-danger btn-sm fa fa-search"
						action="#{custo_pessoal_controller.removerReembolso()}"
						onclick="start()" onsuccess="stop()" onerror="stop()"
						update="cadastro_reembolso" style="color:#fff; margin: 8px 2px;">
						<span style="font-family: Arial">Remover</span>
					</p:commandLink>

					<p:commandLink styleClass="btn btn-danger btn-sm fa fa-search"
						action="#{custo_pessoal_controller.mostrarResumo()}"
						oncomplete="PF('dlg_resumo').show();" onclick="start()"
						onsuccess="stop()" onerror="stop()"
						update=":resumo_reembolso:table_resumo"
						style="color:#fff; margin: 8px 2px;">
						<span style="font-family: Arial">Mostrar resumo</span>
					</p:commandLink>

				</div>

			</p:panel>


			<p:dataTable id="table_custo_reembolso"
				selection="#{custo_pessoal_controller.listaReembolsoSelected}"
				rowKey="#{reembolso.id}"
				value="#{custo_pessoal_controller.reembolsos}" var="reembolso"
				style="margin-bottom:0">


				<p:column headerText="Nº Lançamento" style="width:100px">
					<h:outputText value="#{reembolso.id}" />
				</p:column>

				<p:column headerText="Recebedor">
					<h:outputText value="#{reembolso.contaRecebedor.nomeConta}" />
				</p:column>

				<p:column headerText="competência" style="width:90px">
					<h:outputText value="#{reembolso.competencia}" />
				</p:column>

				<p:column headerText="Dt de Pagamento" style="width:110px">
					<h:outputText value="#{reembolso.dataPagamento}">
						<f:convertDateTime pattern="dd/MM/yyyy" timeZone="America/Manaus" />
					</h:outputText>
				</p:column>

				<p:column headerText="Valor" style="width:110px">
					<h:outputText value="#{reembolso.valorTotalComDesconto}">
						<f:convertNumber type="currency" locale="pt_BR" />
					</h:outputText>

				</p:column>

				<p:column style="width:40px" selectionMode="multiple" />

			</p:dataTable>

		</h:form>
	</ui:define>

	<ui:define name="adicionais">

		<p:dialog header="Resumo" modal="true" widgetVar="dlg_resumo"
			width="80%" hideEffect="clip" closeOnEscape="true" showEffect="clip">
			<h:form id="resumo_reembolso">
				<p:dataTable id="table_resumo"
					value="#{custo_pessoal_controller.listaResumo}" var="resumo">

					<p:column headerText="fonte">
						<h:outputText
							value="#{resumo.rubricaOrcamento.orcamento.fonte.nome}" />
					</p:column>

					<p:column headerText="Doação">
						<h:outputText value="#{resumo.rubricaOrcamento.orcamento.titulo}" />
					</p:column>

					<p:column headerText="Categoria">
						<h:outputText value="#{resumo.rubricaOrcamento.rubrica.nome}" />
					</p:column>

					<p:column style="width:120px">
						<h:outputText style="float:right;" value="#{resumo.valor}">
							<f:convertNumber type="currency" locale="pt_BR" />
						</h:outputText>

					</p:column>

					<p:columnGroup type="footer">
						<p:row>
							<p:column colspan="3" footerText="Total: "
								style="text-align:right" />
							<p:column style="text-align:right"
								footerText="#{custo_pessoal_controller.buscarValorTotal(custo_pessoal_controller.valorTotalResumo)}" />
						</p:row>


					</p:columnGroup>

				</p:dataTable>
			</h:form>

		</p:dialog>


		<p:dialog modal="true" style="z-index:1000" widgetVar="statusDialog"
			showHeader="false" draggable="false" closable="false"
			resizable="false">
			<p:graphicImage library="image" name="aguarde.gif" />
			<p:graphicImage style="width:120px;height:70px" library="image"
				name="logofas.png" />
		</p:dialog>
	</ui:define>


</ui:composition>