<ui:fragment xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
	xmlns:jsf="http://xmlns.jcp.org/jsf">

	<div style="padding: 2px 2px">
		<p:growl id="growl" showDetail="true" sticky="true" />

		<p:panel id="panel-relacao-orcamento">


			<div class="ui-g ui-fluid">


				<div class="ui-g-3 form-group">

					<p:outputLabel value="Doação" for="donation" />
					<p:selectOneMenu id="donation" style="width:100%"
						value="#{projetoBean.donation}" filter="true"
						filterMatchMode="contains" converter="orcamentoConverter">
						<f:selectItem noSelectionOption="true"/>
						<f:selectItems value="#{projetoBean.listOfDonation}"
							var="donation" itemLabel="#{donation.titulo}"
							itemValue="#{donation}" />

						<p:ajax event="change" update="rubrica"
							listener="#{projetoBean.carregasRubricasOrcadas()}" />

					</p:selectOneMenu>
				</div>

				<div class="ui-g-3 form-group">

					<p:outputLabel value="Categoria" for="rubrica" />
					<p:selectOneMenu id="rubrica" style="width:100%"
						value="#{projetoBean.projetoRubrica.rubricaOrcamento}" var="rb"
						converter="rubricaOrcamentoConverter" filter="true"
						filterMatchMode="contains">
						<f:selectItems value="#{projetoBean.listaDeRubricasOrcadas}"
							var="rubrica" itemLabel="#{rubrica.rubrica.nome}"
							itemValue="#{rubrica}" />

						<p:column>
							<h:outputText value="#{rb.orcamento.titulo}" />
						</p:column>

						<p:column>
							<h:outputText value="#{rb.componente.nome}" />
						</p:column>

						<p:column>
							<h:outputText value="#{rb.subComponente.nome}" />
						</p:column>

						<p:column>
							<h:outputText value="#{rb.rubrica.nome}" />
						</p:column>

					</p:selectOneMenu>

				</div>

				<div class="ui-g-3 form-group">
					<p:outputLabel value="Valor" for="valor_liberado_rubrica" />
					<p:inputText id="valor_liberado_rubrica"
						value="#{projetoBean.projetoRubrica.valor}"
						onkeydown="mascaraMoeda(this,moeda)" required="true"
						requiredMessage="Campo obrigatório">
						<f:convertNumber minFractionDigits="2" maxFractionDigits="2"
							locale="pt_BR" />
					</p:inputText>
				</div>

				<div class="ui-g-3 form-group">
					<p:commandLink styleClass="btn btn-success btn-sm"
						style="margin-left:5px" title="Salvar"
						action="#{projetoBean.salvarProjetoRubrica()}">
						<span class="fa fa-plus"></span>
						<span style="margin: 3px;">Incluir</span>
					</p:commandLink>
				</div>


				<div class="ui-g-12 form-group">
					<p:dataTable id="table-relacao-rubrica"
						value="#{projetoBean.listaDeRubricasProjeto}" var="projetoRubrica">


						<p:column headerText="Doação" style="width:120px">
							<h:outputText
								value="#{projetoRubrica.rubricaOrcamento.orcamento.titulo}" />
						</p:column>


						<p:column headerText="Componente" style="width:120px">
							<h:outputText
								value="#{projetoRubrica.rubricaOrcamento.componente.nome}" />
						</p:column>

						<p:column headerText="SubComponente">
							<h:outputText
								value="#{projetoRubrica.rubricaOrcamento.subComponente.nome}" />
						</p:column>

						<p:column headerText="Categoria">
							<h:outputText
								value="#{projetoRubrica.rubricaOrcamento.rubrica.nome}" />
						</p:column>

						<p:column width="120" headerText="Valor">
							<h:outputText value="#{projetoRubrica.valor}">
								<f:convertNumber type="currency" maxFractionDigits="2"
									currencySymbol="R$" />
							</h:outputText>
						</p:column>

						<p:column headerText="#" style="text-align: center;">
									<p:commandLink process="@this"
										action="#{projetoBean.preparaEdicaoRubricaProjeto()}"
										styleClass="btn btn-warning">
										<span class="fa fa-edit"></span>
										<f:setPropertyActionListener value="#{projetoRubrica}"
											target="#{projetoBean.projetoRubrica}" />
									</p:commandLink>

									<p:commandLink style="color:#FFF"
										styleClass="btn btn-danger" process="@this"
										action="#{projetoBean.removerProjetoRubrica()}">
										<span class="fa fa-fw fa-trash-o"></span>
										<f:setPropertyActionListener value="#{projetoRubrica}"
											target="#{projetoBean.projetoRubrica}" />
									</p:commandLink>
						</p:column>

						<p:columnGroup type="footer">
							<p:row>
								<p:column colspan="4" footerText="Subtotal: "
									style="text-align:right" />
								<p:column style="text-align:right"
									footerText="#{projetoBean.buscarValorTotal()}" />
								<p:column></p:column>
							</p:row>

						</p:columnGroup>
					</p:dataTable>
				</div>
			</div>
		</p:panel>

	</div>
</ui:fragment>