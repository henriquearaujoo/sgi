<!DOCTYPE html>
<ui:composition template="/WEB-INF/LayoutFullPage.xhtml"
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
	xmlns:jsf="http://xmlns.jcp.org/jsf" xmlns:o="http://omnifaces.org/ui">


	<ui:define name="content">

		<h:form acceptcharset="ISO-8859-1" id="form-cadastro-viagem" styleClass="default-style-form-filter"
			prependId="false">

			<p:messages id="messages" showSummary="false" style="margin-top:10px"
				showDetail="true" closable="true" showIcon="true">
				<p:autoUpdate />
			</p:messages>

			<f:metadata>
				<o:viewParam name="viagem" value="#{sv_cadastro_controller.viagem}" />
				<f:viewAction action="#{sv_cadastro_controller.init()}"
					onPostback="setarFocused('info-geral');" />
			</f:metadata>

			<p:breadCrumb class="breadcrumb-container">


				<p:menuitem value="Categories" url="home_new.xhtml" />
				<p:menuitem value="Solicitação de Viagem"
					url="SolicitacaoViagem.xhtml" />
				<p:menuitem value="Cadastro de viagem" />
			</p:breadCrumb>

			<div id="steps">
				<p:steps widgetVar="tabViewVar" rendered="true" id="step"
					activeIndex="#{sv_cadastro_controller.stepIndex}"
					styleClass="custom" style="margin-bottom:10px" readonly="false">
					<p:menuitem value="Informações gerais" />
					<p:menuitem value="Diárias" rendered="#{sv_cadastro_controller.viagem.id != null ? true : false}" />
					<p:menuitem value="Programação" rendered="#{sv_cadastro_controller.viagem.id != null ? true : false}" />
					<p:menuitem value="Despesas" rendered="#{sv_cadastro_controller.viagem.id != null ? true : false}" />
					<p:menuitem value="Confirmação" rendered="#{sv_cadastro_controller.viagem.id != null ? true : false}" />
				</p:steps>
			</div>

			<div id="panel-geral">

				<p:panel id="panel-info-geral" styleClass="tab-menu-item-vi">

					<ui:include src="/main/viagem/info_geral.xhtml" />

				</p:panel>

				<p:panel id="panel-info-diaria" styleClass="tab-menu-item-vi"
					style="display: none;">

					<p:outputPanel id="cadastro_diaria">
						<div id="info-diaria" class="ui-g ui-fluid">

							<ui:include src="/main/viagem/diarias.xhtml" />

						</div>
					</p:outputPanel>

				</p:panel>

				<p:panel id="panel-info-programacao" style="display: none"
					styleClass="tab-menu-item-vi">

					<div id="info-prorgramacao" class="ui-g ui-fluid">

						<ui:include src="/WEB-INF/sv03.xhtml" />

					</div>

				</p:panel>

				<p:panel id="panel-info-despesas" style="display: none"
					styleClass="tab-menu-item-vi">

					<div id="info-despesas" class="ui-g ui-fluid">

						<ui:include src="/WEB-INF/sv04.xhtml" />

					</div>

				</p:panel>


				<p:panel id="panel-info-confirmacao" styleClass="tab-menu-item-vi"
					style="display: none">
					<div id="info-confirmacao" class="tab-menu-item-vi"></div>
				</p:panel>
			</div>

			<div class="fixed-btn">

				<p:panel id="btn-panel-p">

					<div id="btn-panel-wizard" class="ui-g ui-fluid"
						style="margin-bottom: 10px">


						<div class="ui-g-6">

							<p:commandLink styleClass="btn btn-primary"
								action="#{sv_cadastro_controller.salvarViagem()}"
								onclick="start()" onsuccess="stop()" onerror="stop()"
								oncomplete="PF('dlg_escolha_page').show();"
								rendered="#{sv_cadastro_controller.podeEditar}"
								style="color:#fff; margin: 2px 2px;">
								<span class="glyphicon glyphicon-floppy-disk"></span>
								<span style="margin: 3px;">Salvar</span>
							</p:commandLink>


							<p:commandLink onclick="start()" onsuccess="stop()"
								onerror="stop()"
								rendered="#{sv_cadastro_controller.viagem.id != null and sv_cadastro_controller.podeEditar}"
								action="#{sv_cadastro_controller.autorizar()}"
								styleClass="btn btn-success btn-sm"
								style="color:#fff; margin: 2px 2px;">
								<p:confirm header="Confirmação" message="Autorizar solicitação?"
									icon="ui-icon-alert" />
								<span class="glyphicon glyphicon-ok"></span>
								<span style="margin: 3px;">Autorizar</span>
							</p:commandLink>

							<p:commandLink
								rendered="#{sv_cadastro_controller.viagem.id != null}"
								styleClass="btn btn-default btn-sm" ajax="false" process="@this"
								target="_blank"
								action="#{sv_cadastro_controller.gerarRelatorioViagem()}"
								style="color:#000; margin: 2px 2px;">
								<span class="glyphicon glyphicon-print"></span>
								<span style="margin: 3px;">Imprimir</span>
							</p:commandLink>


						</div>

						<div class="ui-g-6" style="text-align: right">

							<p:commandLink id="btn-back" styleClass="btn btn-primary"
								update="step, btn-back, btn-next, btn-panel-p" value="Voltar"
								process="@this" rendered="#{sv_cadastro_controller.viagem.id != null ? true : false}"
								onclick="steping(#{sv_cadastro_controller.stepIndex - 1});start()"
								oncomplete="stop()" onerror="stop()"
								action="#{sv_cadastro_controller.steping('back')}"></p:commandLink>

							<p:commandLink id="btn-next" styleClass="btn btn-primary"
								rendered="#{sv_cadastro_controller.viagem.id != null ? true : false}"
								update="step, btn-back, btn-next, btn-panel-p" value="Próximo"
								onclick="steping(#{sv_cadastro_controller.stepIndex + 1});start()"
								oncomplete="stop()" onerror="stop()" process="@this"
								action="#{sv_cadastro_controller.steping('next')}"></p:commandLink>


						</div>

						<div id="actions-button" class="ui-g-12" style="display: none">

							<div class="ui-g-12" style="text-align: right;"></div>
						</div>

					</div>

				</p:panel>
			</div>

			<p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
				<p:commandButton value="Sim" styleClass="ui-confirmdialog-yes"
					icon="pi pi-check" />
				<p:commandButton value="Não" styleClass="ui-confirmdialog-no"
					icon="pi pi-times" />
			</p:confirmDialog>



		</h:form>

	</ui:define>

	<ui:define name="adicionais">


		<script type="text/javascript">
			function setarWidthHeight(id) {
				var htmlTag = document.getElementById(id);
				htmlTag.style.height = Math.floor(window.innerHeight*0.98)+"px";	
				htmlTag.style.width = Math.floor(window.innerWidth*0.98)+"px";	
				
			}
		</script>



		<p:dialog modal="true" style="z-index:1000" widgetVar="statusDialog"
			showHeader="false" draggable="false" closable="false"
			resizable="false">
			<p:graphicImage library="image" name="aguarde.gif" />
			<p:graphicImage style="width:120px;height:70px" library="image"
				name="logofas.png" />
		</p:dialog>


		<p:dialog widgetVar="dlg-recurso" modal="true" width="100%"
			height="100%" closable="true" closeOnEscape="true" showHeader="true"
			header="Inclusão de recursos para pagamento" showEffect="clip"
			hideEffect="clip">

			<h:form id="form-dialog-recurso" prependId="false">

				<p:panel id="panel-form-recurso">

					<div class="ui-g ui-fluid"></div>

				</p:panel>

			</h:form>

		</p:dialog>


<!--	Inclusão de diária	-->
		<ui:include id="dialog_inclusao_diaria"
					src="dialog/viagem/inclusao_diaria.xhtml" />

		<p:dialog widgetVar="dlg_impressao" modal="true" closable="true"
			showHeader="false" showEffect="clip" hideEffect="clip">
			<h:form id="form-dialog">
				<p:panelGrid>
					<p:row>
						<p:column colspan="2">
							<div align="center" style="padding: 20px">
								<h:outputText value="Gerar diária?" />
							</div>
						</p:column>
					</p:row>

					<p:row>
						<p:column>
							<p:commandLink value="Sim"
								styleClass="btn btn-default btn-success"
								oncomplete="PF('dlg_impressao').hide();" style="color:#fff"
								action="#{sv_cadastro_controller.geraRelatorioDiaria()}"
								ajax="false" process="@this" target="_blank">
								<span class="glyphicon glyphicon-ok"></span>
							</p:commandLink>
						</p:column>

						<p:column>
							<p:commandLink styleClass="btn btn-default btn-danger"
								style="color:#fff" value="Não"
								onclick="PF('dlg_impressao').hide();PF('statusDialog').hide();">
								<span class="glyphicon glyphicon-remove"></span>
							</p:commandLink>
						</p:column>

					</p:row>

				</p:panelGrid>

			</h:form>
		</p:dialog>


<!--	Recursos	-->
		<ui:include src="dialog/viagem/recurso.xhtml" />

<!--	Trechos	-->
		<ui:include src="dialog/viagem/trechos.xhtml" />

		<p:dialog widgetVar="dlg_escolha_page" modal="true" closable="true"
			showHeader="false" showEffect="clip" hideEffect="clip">

			<h:form>
				<p:panelGrid>
					<p:row>
						<p:column colspan="2">
							<div align="center" style="padding: 20px">
								<h:outputText value="Finalizar processo?" />
							</div>
						</p:column>
					</p:row>

					<p:row>
						<p:column>
							<span class=""></span>
							<p:commandLink styleClass="glyphicon glyphicon-ok"
								style="color:#000" value="Sim" onclick="goBack()">

							</p:commandLink>
						</p:column>

						<p:column>
							<p:commandLink
								styleClass="btn btn-default btn-danger btn-sm btn-block"
								style="color:#fff" value="Não"
								onclick="PF('dlg_escolha_page').hide();PF('statusDialog').hide();"></p:commandLink>
						</p:column>

					</p:row>

				</p:panelGrid>
			</h:form>
		</p:dialog>



		<p:dialog header="Mudança de Status" widgetVar="dialogAlterarStatus"
			modal="false" resizable="false" showEffect="clip" hideEffect="clip">
			<div class="ui-fluid">
				<h:form id="formDialogAlterarStatus">

					<p:panelGrid columns="1" layout="grid">


						<p:selectOneMenu
							value="#{sv_cadastro_controller.diaria.statusCompra}"
							filter="true" filterMatchMode="contains">
							<f:selectItems value="#{sv_cadastro_controller.status}"
								var="status" itemLabel="#{status.nome}" itemValue="#{status}" />
						</p:selectOneMenu>



					</p:panelGrid>
					<div class="botao_central" style="display: flex; justify-content: center">
						<p:commandLink styleClass="btn btn-primary btn-sm"
							update="actions-diaria"
							action="#{sv_cadastro_controller.mudarStatusLancamento()}"
							onclick="start()" onsuccess="stop()" onerror="stop()"
							oncomplete="PF('dialogAlterarStatus').hide()"
							style="color:#fff; margin: 8px 2px;">

							Salvar
						</p:commandLink>

						<p:commandLink styleClass="btn btn-primary btn-sm"
							action="#{sv_cadastro_controller.carregarDiarias()}"
							onclick="PF('dialogAlterarStatus').hide()" ajax="false"
							process="@this" style="color:#fff; margin: 8px 2px;">
						Cancelar
						</p:commandLink>

					</div>
				</h:form>
			</div>
		</p:dialog>



	</ui:define>


</ui:composition>